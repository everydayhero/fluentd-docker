<source>
  @type forward
  port 24224
</source>

<source>
  @type tcp
  format journalctl
  tag journalctl
  port 5170
  bind 0.0.0.0
</source>

<source>
  @type syslog
  format everydayhero
  tag system
  port 5140
  bind 0.0.0.0
</source>

<filter journalctl>
  @type record_transformer

  remove_keys "journalctl.boot_id,journalctl.cap_effective,journalctl.comm,journalctl.cursor,journalctl.exe,journalctl.gid,journalctl.machine_id,journalctl.monotonic_timestamp,journalctl.pid,journalctl.priority,journalctl.realtime_timestamp,journalctl.syslog_facility,journalctl.syslog_identifier,journalctl.systemd_cgroup,journalctl.systemd_slice,journalctl.uid"
</filter>

<match **>
  @type copy
  deep_copy true

  <store>
    @type kinesis

    stream_name "#{ENV['KINESIS_STREAM']}"

    aws_key_id  "#{ENV['AWS_KEY']}"
    aws_sec_key "#{ENV['AWS_SECRET']}"
    region      "#{ENV['AWS_REGION']}"

    random_partition_key true
    order_events false
    num_threads 10
  </store>
</match>
